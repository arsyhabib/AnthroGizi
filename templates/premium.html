{% extends "base.html" %}

{% block title %}Premium Packages - anthroGizi v4.0.0{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Header Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="page-header text-center">
                <h1 class="display-6 fw-bold text-gradient">Premium Packages</h1>
                <p class="lead">Tingkatkan pengalaman Anda dengan fitur eksklusif dan konsultasi profesional</p>
            </div>
        </div>
    </div>

    <!-- Package Comparison -->
    <div class="row mb-5">
        <div class="col-lg-4 mb-4">
            <div class="card package-card h-100">
                <div class="card-header text-center bg-light">
                    <h4 class="mb-2">Free</h4>
                    <div class="price-display">
                        <span class="currency">Rp</span>
                        <span class="price">0</span>
                        <span class="period">/bulan</span>
                    </div>
                    <p class="text-muted mb-0">Untuk pemula</p>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Kalkulator WHO dasar
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            5 kali penggunaan per hari
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Artikel dasar
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Video edukatif terbatas
                        </li>
                        <li class="feature-item text-muted">
                            <i class="fas fa-times text-danger me-2"></i>
                            Konsultasi ahli
                        </li>
                        <li class="feature-item text-muted">
                            <i class="fas fa-times text-danger me-2"></i>
                            Laporan mendalam
                        </li>
                        <li class="feature-item text-muted">
                            <i class="fas fa-times text-danger me-2"></i>
                            Notifikasi khusus
                        </li>
                    </ul>
                </div>
                <div class="card-footer text-center">
                    <button class="btn btn-outline-primary" disabled>
                        Paket Saat Ini
                    </button>
                </div>
            </div>
        </div>

        <div class="col-lg-4 mb-4">
            <div class="card package-card featured h-100">
                <div class="package-badge">
                    <span class="badge bg-warning text-dark">POPULER</span>
                </div>
                <div class="card-header text-center bg-gradient-primary text-white">
                    <h4 class="mb-2">Silver</h4>
                    <div class="price-display">
                        <span class="currency">Rp</span>
                        <span class="price">49.999</span>
                        <span class="period">/bulan</span>
                    </div>
                    <p class="mb-0">Untuk orang tua aktif</p>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Semua fitur Free
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Penggunaan tak terbatas
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Artikel premium
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Video lengkap tanpa iklan
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            2x konsultasi WhatsApp
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Laporan dasar PDF
                        </li>
                        <li class="feature-item text-muted">
                            <i class="fas fa-times text-danger me-2"></i>
                            Prioritas layanan
                        </li>
                    </ul>
                </div>
                <div class="card-footer text-center">
                    <button class="btn btn-primary" onclick="selectPackage('silver')">
                        Pilih Silver
                    </button>
                </div>
            </div>
        </div>

        <div class="col-lg-4 mb-4">
            <div class="card package-card h-100">
                <div class="card-header text-center bg-gradient-success text-white">
                    <h4 class="mb-2">Gold</h4>
                    <div class="price-display">
                        <span class="currency">Rp</span>
                        <span class="price">99.999</span>
                        <span class="period">/bulan</span>
                    </div>
                    <p class="mb-0">Untuk profesional</p>
                </div>
                <div class="card-body">
                    <ul class="feature-list">
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Semua fitur Silver
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Konsultasi tak terbatas
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Prioritas layanan 24/7
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Laporan mendalam Excel/PDF
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Analisis tren pertumbuhan
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Notifikasi kesehatan khusus
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check text-success me-2"></i>
                            Akses data historis lengkap
                        </li>
                    </ul>
                </div>
                <div class="card-footer text-center">
                    <button class="btn btn-success" onclick="selectPackage('gold')">
                        Pilih Gold
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Consultation Features -->
    <div class="row mb-5">
        <div class="col-12">
            <h3 class="section-title mb-4 text-center">
                <i class="fas fa-user-md text-primary me-2"></i>
                Konsultasi dengan Ahli
            </h3>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card expert-card h-100">
                <div class="card-body text-center">
                    <div class="expert-avatar mb-3">
                        <img src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=100&h=100&fit=crop&crop=face" 
                             alt="Dr. Ratih" class="rounded-circle">
                    </div>
                    <h5 class="card-title">Dr. Ratih, Sp.A</h5>
                    <p class="card-text text-muted">Spesialis Anak dengan 15 tahun pengalaman</p>
                    <div class="expert-stats mb-3">
                        <div class="stat-item">
                            <span class="stat-number">2.500+</span>
                            <span class="stat-label">Konsultasi</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">4.9</span>
                            <span class="stat-label">Rating</span>
                        </div>
                    </div>
                    <button class="btn btn-outline-primary" onclick="consultExpert('dr-ratih')">
                        <i class="fab fa-whatsapp me-1"></i>Konsultasi
                    </button>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card expert-card h-100">
                <div class="card-body text-center">
                    <div class="expert-avatar mb-3">
                        <img src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=100&h=100&fit=crop&crop=face" 
                             alt="Sarah" class="rounded-circle">
                    </div>
                    <h5 class="card-title">Sarah, M.Gizi</h5>
                    <p class="card-text text-muted">Ahli Gizi Klinis spesialis anak</p>
                    <div class="expert-stats mb-3">
                        <div class="stat-item">
                            <span class="stat-number">1.800+</span>
                            <span class="stat-label">Konsultasi</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">4.8</span>
                            <span class="stat-label">Rating</span>
                        </div>
                    </div>
                    <button class="btn btn-outline-primary" onclick="consultExpert('sarah')">
                        <i class="fab fa-whatsapp me-1"></i>Konsultasi
                    </button>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card expert-card h-100">
                <div class="card-body text-center">
                    <div class="expert-avatar mb-3">
                        <img src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=100&h=100&fit=crop&crop=face" 
                             alt="Dr. Andi" class="rounded-circle">
                    </div>
                    <h5 class="card-title">Dr. Andi, Sp.A</h5>
                    <p class="card-text text-muted">Spesialis Tumbuh Kembang Anak</p>
                    <div class="expert-stats mb-3">
                        <div class="stat-item">
                            <span class="stat-number">3.200+</span>
                            <span class="stat-label">Konsultasi</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">4.9</span>
                            <span class="stat-label">Rating</span>
                        </div>
                    </div>
                    <button class="btn btn-outline-primary" onclick="consultExpert('dr-andi')">
                        <i class="fab fa-whatsapp me-1"></i>Konsultasi
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Testimonials -->
    <div class="row mb-5">
        <div class="col-12">
            <h3 class="section-title mb-4 text-center">
                <i class="fas fa-star text-warning me-2"></i>
                Testimoni Pengguna Premium
            </h3>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card testimonial-card h-100">
                <div class="card-body">
                    <div class="testimonial-rating mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="testimonial-text mb-3">
                        "Konsultasi dengan Dr. Ratih sangat membantu. Sekarang saya tahu cara yang tepat memberikan MPASI untuk bayi saya."
                    </p>
                    <div class="testimonial-author">
                        <strong>Ibu Sari</strong>
                        <span class="text-muted">- Pengguna Silver</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card testimonial-card h-100">
                <div class="card-body">
                    <div class="testimonial-rating mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="testimonial-text mb-3">
                        "Fitur Gold sangat lengkap. Laporan pertumbuhan anak saya sangat detail dan membantu monitoring perkembangannya."
                    </p>
                    <div class="testimonial-author">
                        <strong>Bapak Andi</strong>
                        <span class="text-muted">- Pengguna Gold</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 mb-3">
            <div class="card testimonial-card h-100">
                <div class="card-body">
                    <div class="testimonial-rating mb-3">
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <p class="testimonial-text mb-3">
                        "Respons dokter sangat cepat dan solusi yang diberikan sangat praktis. Worth it untuk langganan premium!"
                    </p>
                    <div class="testimonial-author">
                        <strong>Ibu Maya</strong>
                        <span class="text-muted">- Pengguna Gold</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="row">
        <div class="col-12">
            <h3 class="section-title mb-4 text-center">
                <i class="fas fa-question-circle text-info me-2"></i>
                Pertanyaan yang Sering Diajukan
            </h3>
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            Bagaimana cara berlangganan paket premium?
                        </button>
                    </h2>
                    <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Anda dapat berlangganan langsung melalui aplikasi dengan metode pembayaran yang tersedia (transfer bank, kartu kredit, e-wallet).
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                            Apakah bisa upgrade/downgrade paket?
                        </button>
                    </h2>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Ya, Anda dapat mengubah paket kapan saja. Perubahan akan berlaku pada periode billing berikutnya.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                            Bagaimana sistem konsultasi WhatsApp?
                        </button>
                    </h2>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Setelah berlangganan, Anda akan mendapatkan nomor WhatsApp khusus untuk konsultasi. Respon akan diberikan dalam waktu 2-4 jam pada hari kerja.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.package-card {
    border: 2px solid var(--border-color);
    transition: all 0.3s ease;
    position: relative;
}

.package-card.featured {
    border-color: var(--primary-color);
    transform: scale(1.05);
    z-index: 1;
}

.package-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.package-card.featured:hover {
    transform: scale(1.05) translateY(-5px);
}

.package-badge {
    position: absolute;
    top: -10px;
    right: 20px;
    z-index: 2;
}

.price-display {
    display: flex;
    align-items: baseline;
    justify-content: center;
    margin: 1rem 0;
}

.price-display .currency {
    font-size: 1.5rem;
    margin-right: 0.25rem;
}

.price-display .price {
    font-size: 2.5rem;
    font-weight: bold;
}

.price-display .period {
    font-size: 1rem;
    color: var(--text-muted);
    margin-left: 0.25rem;
}

.feature-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.feature-item {
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border-color);
}

.feature-item:last-child {
    border-bottom: none;
}

.expert-card {
    transition: transform 0.2s ease;
}

.expert-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.expert-avatar img {
    width: 80px;
    height: 80px;
    object-fit: cover;
}

.expert-stats {
    display: flex;
    justify-content: center;
    gap: 2rem;
}

.stat-item {
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 1.25rem;
    font-weight: bold;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.875rem;
    color: var(--text-muted);
}

.testimonial-card {
    border-left: 4px solid var(--primary-color);
}

.testimonial-rating {
    font-size: 1rem;
}

.testimonial-text {
    font-style: italic;
    color: var(--text-secondary);
}

.section-title {
    color: var(--primary-color);
    border-bottom: 2px solid var(--primary-color);
    padding-bottom: 0.5rem;
}

.accordion-button:not(.collapsed) {
    background-color: var(--primary-bg);
    color: var(--primary-color);
}
</style>

<script>
// Premium Package System
class PremiumSystem {
    constructor() {
        this.selectedPackage = null;
        this.experts = {
            'dr-ratih': {
                name: 'Dr. Ratih, Sp.A',
                phone: '+6281234567890',
                available: true
            },
            'sarah': {
                name: 'Sarah, M.Gizi',
                phone: '+6281234567891',
                available: true
            },
            'dr-andi': {
                name: 'Dr. Andi, Sp.A',
                phone: '+6281234567892',
                available: false
            }
        };
    }

    selectPackage(packageType) {
        this.selectedPackage = packageType;
        
        const packageNames = {
            'silver': 'Silver (Rp49.999/bulan)',
            'gold': 'Gold (Rp99.999/bulan)'
        };
        
        // Show subscription modal
        this.showSubscriptionModal(packageNames[packageType]);
    }

    showSubscriptionModal(packageName) {
        const modal = `
            <div class="modal fade" id="subscriptionModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Berlangganan ${packageName}</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form id="subscriptionForm">
                                <div class="mb-3">
                                    <label class="form-label">Nama Lengkap</label>
                                    <input type="text" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Nomor WhatsApp</label>
                                    <input type="tel" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Metode Pembayaran</label>
                                    <select class="form-select" required>
                                        <option value="">Pilih metode</option>
                                        <option value="transfer">Transfer Bank</option>
                                        <option value="credit">Kartu Kredit</option>
                                        <option value="ewallet">E-Wallet</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                            <button type="button" class="btn btn-primary" onclick="premiumSystem.processSubscription()">Lanjutkan Pembayaran</button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modal);
        const modalInstance = new bootstrap.Modal(document.getElementById('subscriptionModal'));
        modalInstance.show();
        
        // Clean up modal after closing
        document.getElementById('subscriptionModal').addEventListener('hidden.bs.modal', function() {
            this.remove();
        });
    }

    processSubscription() {
        const form = document.getElementById('subscriptionForm');
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }
        
        // Simulate payment processing
        showNotification('Memproses pembayaran...', 'info');
        
        setTimeout(() => {
            showNotification('Pembayaran berhasil! Selamat berlangganan!', 'success');
            const modal = bootstrap.Modal.getInstance(document.getElementById('subscriptionModal'));
            modal.hide();
        }, 2000);
    }

    consultExpert(expertId) {
        const expert = this.experts[expertId];
        if (!expert) return;
        
        if (!expert.available) {
            showNotification(`${expert.name} sedang tidak tersedia. Silakan coba lagi nanti.`, 'warning');
            return;
        }
        
        // Check if user has premium access
        if (!this.checkPremiumAccess()) {
            this.showPremiumRequiredModal();
            return;
        }
        
        // Open WhatsApp consultation
        const message = `Halo ${expert.name}, saya ingin berkonsultasi tentang gizi anak saya.`;
        const whatsappUrl = `https://wa.me/${expert.phone}?text=${encodeURIComponent(message)}`;
        
        window.open(whatsappUrl, '_blank');
    }

    checkPremiumAccess() {
        // In a real application, this would check user's subscription status
        return Math.random() > 0.7; // 30% chance of not having premium
    }

    showPremiumRequiredModal() {
        const modal = `
            <div class="modal fade" id="premiumRequiredModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Diperlukan Akses Premium</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <p>Untuk mengakses fitur konsultasi dengan ahli, Anda perlu berlangganan paket Silver atau Gold.</p>
                            <p>Manfaat premium:</p>
                            <ul>
                                <li>Konsultasi langsung dengan ahli gizi dan dokter spesialis</li>
                                <li>Respon cepat dalam 2-4 jam</li>
                                <li>Solusi praktis dan terpercaya</li>
                            </ul>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Nanti Saja</button>
                            <button type="button" class="btn btn-primary" onclick="window.location.href='#packages'">Lihat Paket</button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modal);
        const modalInstance = new bootstrap.Modal(document.getElementById('premiumRequiredModal'));
        modalInstance.show();
        
        document.getElementById('premiumRequiredModal').addEventListener('hidden.bs.modal', function() {
            this.remove();
        });
    }
}

// Global functions
function selectPackage(packageType) {
    premiumSystem.selectPackage(packageType);
}

function consultExpert(expertId) {
    premiumSystem.consultExpert(expertId);
}

// Initialize Premium System
const premiumSystem = new PremiumSystem();

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Add smooth scrolling to packages section
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });
});
</script>
{% endblock %}